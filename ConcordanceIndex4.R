ConcordanceIndex4 <- function(exprs.matrix, stime, sevent, strat, weights, nbcore=1){  # Compute the concordance index for each individual gene  # based on the survcomp package  #  #   Args:  #   gene.id: The gene of importance to extract C index  #   exprs.matrix: Matrix containing all the gene expression for the dataset  #   stime: survival time  #   sevent: survival event  #   strat: strata factors (usually datasets)  #   weights: sample weights (subtype probabilities for instance)  #  # Returns:  #  a matrix containing the concordance index, its standard error and corresponding two-sided p-value     require(mRMRe)  oldnbcore <- get.thread.count()  set.thread.count(nbcore)    if(missing(strat)) {    strat <- as.factor(rep(1, ncol(exprs.matrix)))    names(strat) <- colnames(exprs.matrix)  }  ## create mRMRe.Data object  mdata <- mRMRe::mRMR.data(data=data.frame("SURV"=Surv(stime, sevent), t(exprs.matrix)), weights=weights, strata=strat)  ## perform classic mRMR with solution length of 1  classic.m <- mRMRe::mRMR.classic(mdata, feature_count=1, target_indices=1)  set.thread.count(oldnbcore)  res <- mim(classic.m, method="cor")[1, -1] / 2 + 0.5  res <- cbind("cindex"=res, "se"=NA, "p"=NA)    return(res)}